// ========================== //
//           Frasi            //
// ========================== //
const frasi = [
    "Amore mio â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸ secondo me te lo aspettavi che stasera ti scrivessi qualcosa perchÃ© sei andato a letto presto e questo forse Ã¨ l'unica cosa positiva che riesco a trovare se vai a letto presto. Intanto ti volevo dire che mi manchi e che ti amo, ma oltre a questo volevo anche dirti che ti penso sempre, in ogni minuto, ti penso adesso che sto da sola nel letto e penso a quanto vorrei averti nell'altra parte del letto, ti ho pensato quando sono andata a farmi la doccia (indovina per cosa ti ho pensato ðŸ˜‰), ti penso quando vado a cena, ti penso quando mi sfioro i capelli, ti penso sempre quando mi tocco, beh insomma ti ho sempre in testa, ho sempre la voglia e il desiderio che tu stia qui con me, perchÃ© piÃ¹ passano i giorni e piÃ¹ mi manchi come l'aria. Abbiamo sempre saputo che essere lontani non sarebbe stato facile e l'abbiamo accettato entrambi, e ad oggi non mi sono mai pentita e non mi pentirÃ² mai di questa mia scelta, spero che tu amore mio farai lo stesso, perchÃ© non riuscirei a sopportare che mi dovessi dire un giorno che ti sei pentito di tutto questo. Mi manchi, cristo se mi manchi Davide e anche tanto, mi manchi nei momenti piÃ¹ semplici, mi manchi quando vedo per strada una famiglia felice oppure mi manchi quando una coppia va all' Ikea per scegliere i mobili della casa, mi manchi quando canto sotto la doccia, mi manchi quando cucino, e mi manchi in tantissime altre attivitÃ . Come dicevo entrambi abbiamo sempre saputo la difficoltÃ  della nostra relazione, ma io sento che posso farcela, posso fare questo salto nel buio per te, con te, perchÃ© ti amo, per pregi e difetti e la mia vita, i miei sogni, la mia famiglia non sarÃ  mai completa se non ci sarai te, accanto a me. Io voglio superare i miei limiti, le mie paure e lo voglio fare per te, ma soprattutto lo voglio fare per me stessa perchÃ© mi sono stancata di farmi schifo, sia esteticamente che mentalmente, ho sempre cercato di trattenermi, di non essere me stessa per paura di essere giudicata ma sei stato proprio te amore mio a farmi capire quanto io sia buona, troppo forse, forte, e certe volte bella, e voglio apprezzare tutto questo di me perchÃ© grazie a te ho capito che non faccio cosÃ¬ schifo e che qualcuno che mi amerÃ  ci sarÃ  sempre. Oggi confermo quello che ho detto il 12 maggio di un'anno fa ormai, noi non nasciamo con il libretto delle istruzioni e forse tutto questo ad oggi Ã¨ piÃ¹ una cosa positiva che negativa, perchÃ© grazie a te ho capito che c'Ã¨ veramente qualcosa di bello ed emozionante nell'improvvisare, non dover essere necessario un piano per vivere la vita, per vivere insieme a te. Amore mio in due mesi e passa ormai ne abbiamo passate di cose insieme e chissÃ  che cosa la vita ci riserverÃ  per il nostro futuro, spero una bella casa, una famiglia dolce, avvolgente, magari con 4 o anche di piÃ¹ piedini per casa e delle zampette e zampone, magari un bel giardino dove farvi dei picnic ðŸ˜‰, dei viaggi in giro per il mondo, Parigi, Oslo, New Orleans, Mosca, Tokyo e ovviamente Amsterdam non pensare che me lo sia dimenticato. Per noi amore mio spero tutto questo e anche molto di piÃ¹. Quando ti faccio queste lettere per farti emozionare cerco sempre delle grandi parole per farti capire quanto io ti amo, ma ad oggi ho capito che i gesti valgono di piÃ¹ delle parole, ma non vedo l'ora di riempirti di gesti: di coccole, di grattini sulle braccia, o delle carezze tra i capelli per tranquillizzarti, voglio riempirti di baci, voglio baciarti ovunque, sul petto, sul collo e naturalmente sulle labbra, voglio abbracciarti nelle notti difficili per farti capire che ci sono e che per te ci sarÃ² sempre, voglio fare l'amore con te sempre finchÃ© non ti stancherai, finchÃ© non mi vorrai piÃ¹ vedere, perchÃ© fare tutto ciÃ² con l'amore della mia vita non sarÃ  mai solo sesso ma sarÃ  sempre e unicamente amore, un amore fatto anche di quello, ho sempre pensato che la mia prima volta sarebbe stata drammatica, io sarei stata impacciata, imbranata e per niente attraente come nella vita, ma ad oggi penso che non mi importerebbe se fossi imbranata con te, perchÃ© te vorresti fare l'amore con me e non solo sesso e io vorrei farlo con te perchÃ© sei il posto dove voglio stare, perchÃ© sei il mio rifugio e la mia pace, fare l'amore con te vorrebbe dire dimenticarsi di tutto il resto, di tutte le nostre ansie, di tutti i nostre preoccupazioni e paure perchÃ© a quel punto saremo finalmente insieme e niente potrebbe rovinare la perfezione di quel momento, neanche le nostre insicurezze che sappiamo entrambi di avere. Mi stai facendo amare la vita ogni volta sempre un po' di piÃ¹, perchÃ© nei tuoi occhi leggo un amore e una serenitÃ  che sono fuori di testa, io ti guardo dentro quegli stupendi occhi che hai e in quel momento potrebbe succedere qualunque catastrofe ma non vorrei essere da nessun'altra parte se non lÃ¬ a fissare gli occhi dell'uomo che amo piÃ¹ della mia stessa vita, quell'uomo che sa tutto di me e che cerca di fare qualsiasi cosa per farmi stare bene, tu amore mi tratti esattamente come una farfalla, una creatura cosÃ¬ vulnerabile ma al tempo stesso bella e preziosa perchÃ© non sai quando si potrÃ  spezzare e quindi la maneggi con cautela, io mi sento cosÃ¬ quando sono con te, mi sento una bambina piccola che viene maneggiata con cautela per quanto piccola e preziosa. Voglio dirti anche quanto apprezzi veramente tanto il fatto che tu voglia parlare con tuo padre di me, perchÃ© questo vorrebbe dire niente piÃ¹ nascondigli, meno accortezze, meno cautela, saremo finalmente piÃ¹ liberi amore mio, ovviamente non avrai mai un obbligo da parte mia perÃ² sappi che quando glielo dirai io sarÃ² molto bimba felice amore mio.  â¤ï¸â¤ï¸ Stasera mi sono liberata da alcune cose che volevo dirti e che mi portavo dentro da un po', spero seriamente che leggerai tutto con attenzione perchÃ© in questa lettera c'Ã¨ una buona parte del mio cuoricino. Amore promettimi solo che non ti dimenticherai mai di tutto quello che stai provando per me adesso, promettimi solo che non mi dimenticherai mai e che mi chiamerai sempre amore, perchÃ© finchÃ© ho il tuo cuore e il tuo amore tutto andrÃ  come deve andare, perchÃ© noi siamo amore. Adesso amore vado a nanna anch'io e spero davvero di riuscire a sognare l'Uomo che mi ha cambiato la vita. Buonanotte amore mio â¤ï¸, anzi per te buongiorno vita mia â¤ï¸â¤ï¸â¤ï¸ ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ TI AMO DA MORIRE, DA IMPAZZIRE, FOLLEMENTE DADO â¤ï¸â¤ï¸â¤ï¸",
    "ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹BUONGIORNO AMOREEE MIOOOOâ™¥ï¸â™¥ï¸â™¥ï¸â™¥ï¸devo dire che questa volta ti sei proprio superata amoreðŸ¥¹e un pochino si me lo aspettavo e poi prima quando ho preso il telefono e visto Ä¾icona delle notifiche di whatsaap mi Ã¨ partito un sorriso da parte a parte, e devo dire che sta volta mi sono emozionato ancora piÃ¹ della altre volte, so di averti aiutato ma non pensavo che facendo piccoli gesti di averti aiutato cosÃ¬ e questo mi fa stare ancora meglio il cuoricino, perchÃ© amore per me sei sempre nei miei pensieri e mai niente e nessuno potrÃ  sradicarti dal li, io non mi sono pentito, non mi pento e mai mi pentirÃ² della decisione che ho preso il 25 luglio perchÃ© Ã¨ stata la giornata piÃ¹ bella della mia vita dove ci siamo fidanzati e mai mene pentirÃ² di averti detto si, io nano mai smetterÃ² di chiamarti amore se non dopo la mia morte perchÃ© voglio stare per sempre con te perchÃ© sei la donna della mia vita, non mi dimenticherÃ² mai di tutto questo non mi dimenticherÃ² mai di noi, la nostra distanza Ã¨ importante ma questa Ã¨ una sfida che affronto senza problemi anche se mi manchi e mi manchi da morire perchÃ© sol il dispiacere di non poter sentire la tua bellissima voce o vedere il tuo bel visino non sai quanto mi faccia star male, ma penso sempre al fatto che Ã¨ una situazione temporanea perchÃ© so che poi ti vedrÃ² e so che un giorno non ci sarÃ  piÃ¹ bisogno perchÃ© saremo insieme felici e piÃ¹ avanti insieme con delle zampette, zampe e qualche piccolo piedino in piÃ¹, perchÃ© creare una famiglia con te Ã¨ un sogno che si avvera una famiglia costruita sulÄ¾ amore reciproco. Ti dico un altra cosa che non c'entra niente ma tu non sai quanto vorrei che Ä¾ 11 tu sia con me per festeggiare il mio compleanno lo vorrei piÃ¹ di qualsiasi altra cosaðŸ¥¹ volevo semplicemente dirtelo. E poi altra cosa importante che come ben sai non sei Ä¾ unica che si tocca solo con Ä¾ aiuto del pensiero perchÃ© far Ä¾ amore Ã¨ una altra delle cose che vorrei fare con te e lo vorrei fare davvero tanto ma anche qui so che un giorno lo faremo e sono sicuro che lo faremo un po in tutti i modiðŸ˜‰, e qui momenti di pura eccitazione del fine settimana o come quello di ieri dove mi era presa un eccitazione da morire io gli adoro un saccoðŸ˜‰â™¥ï¸, comunque amore so che non sarÃ  lungo come il tuo ma voglio dirti che ti amo e cazzo se ti amo da morire perchÃ© vali piÃ¹ della mia stessa vitaâ™¥ï¸â™¥ï¸â™¥ï¸â™¥ï¸, BUONGIORNO ANCORA LISETTA MIAâ™¥ï¸â™¥ï¸â™¥ï¸â™¥ï¸ TI AMO DA IMPAZZIRE, TANTO DA DIVENTARE FOLLIAAAâ™¥ï¸â™¥ï¸â™¥ï¸â™¥ï¸â™¥ï¸â™¥ï¸â™¥ï¸, Spero di averti fatto svegliare col piede giusto â™¥ï¸â™¥ï¸â™¥ï¸â™¥ï¸",
    "Ad oggi sei l'unica forza che mi tiene in piedi, grazie a te io non crollo e non potrÃ² mai crollare finchÃ© tu sei al mio fianco a sorreggermi â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸",
    "Puoi stare altri 5 minuti con me ðŸ¥ºðŸ¥º",
    "Ho provato a togliere il telefono ma non riuscivo a darti la buonanotte perchÃ© mi manchi tanto â¤ï¸",
    "Davide mi stai facendo impazzire â¤ï¸",
    "PerchÃ© non sei qui amore mio â¤ï¸â¤ï¸â¤ï¸â¤ï¸ðŸ¥ºðŸ¥ºðŸ¥ºðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹",
    "Io non so che cosa mi aspetta nel futuro quello che so Ã¨ che lo voglio passare con te â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹",
    "Sei il mio posto preferito dove tornare, sempre â¤ï¸â¤ï¸",
    "Da quando ci sei tu tutto Ã¨ piÃ¹ bello Ã¨ migliore â¤ï¸â¤ï¸â¤ï¸â¤ï¸ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹",
    "Ogni volta che penso a te, sorrido senza motivo â¤ï¸â¤ï¸â¤ï¸â¤ï¸",
    "CercherÃ² di fare qualunque cosa per essere la donna della tua vita e la mamma dei tuoi figli â¤ï¸â¤ï¸â¤ï¸ðŸ¥¹ðŸ¥¹",
    "Ci sarÃ  solo un uomo importante come te e sarÃ  il nostro Ema â¤ï¸â¤ï¸ðŸ¥¹ðŸ¥¹ðŸ¥¹",
    "Mi hai reso felice â¤ï¸â¤ï¸â¤ï¸ðŸ¥¹ðŸ¥¹ðŸ¥¹",
    "Quindi possiamo stare insieme? â¤ï¸â¤ï¸â¤ï¸â¤ï¸ðŸ¥¹ðŸ¥¹ðŸ¥¹",
    "Io ho tralasciato la parte piÃ¹ bella ho tralasciando il modo in cui mi toccavi...",
    "Era come se fossimo giÃ  andati a convivere perchÃ© c'era una casa nÃ© la mia nÃ© la tua e ci eravamo solo noi e stavamo andando a dormire...",
    "Io ho bisogno della mia luce nella mia vita â¤ï¸â¤ï¸â¤ï¸â¤ï¸",
    "Ãˆ buffo perchÃ© penso che tu sia la luce della mia di vita â¤ï¸â¤ï¸â¤ï¸â¤ï¸ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹",
    "Io anche amore mio perchÃ© senza di te la mia vita non ha davvero senso â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸",
    "E grazie di esserci sempre â¤ï¸â¤ï¸â¤ï¸",
    "Ma io come ho fatto per meritarti â¤ï¸â¤ï¸â¤ï¸â¤ï¸",
    "Ti amo da impazzire â¤ï¸â¤ï¸â¤ï¸",
    "Amore mio ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹ðŸ¥¹"
];

function showRandomFrase() {
    const fraseEl = document.getElementById('frase');
    const randomIndex = Math.floor(Math.random() * frasi.length);
    fraseEl.innerText = frasi[randomIndex];
}

// ========================== //
//         Sezioni MenÃ¹       //
// ========================== //
function showSection(sectionId) {
    document.querySelectorAll('.section').forEach(section => {
        if(section.id === sectionId){
            section.style.display = 'block';
            setTimeout(() => section.classList.add('active'), 20);
        } else {
            section.style.display = 'none';
            section.classList.remove('active');
        }
    });

    const menu = document.getElementById('menu');
    if (sectionId === 'menu') {
        menu.classList.remove('hidden-menu');
        menu.classList.add('visible-menu');
    } else {
        menu.classList.remove('visible-menu');
        menu.classList.add('hidden-menu');
    }

    if (sectionId === 'countdown') startCountdown();
}

// ========================== //
//         Countdown          //
// ========================== //
let countdownInterval;
function startCountdown() {
    const countdownDate = new Date("January 3, 2026 00:00:00").getTime();
    const clock = document.getElementById('digitalClock');

    if(countdownInterval) clearInterval(countdownInterval);

    countdownInterval = setInterval(() => {
        const now = new Date().getTime();
        const distance = countdownDate - now;

        if(distance < 0){
            clock.innerHTML = "00:00:00:00";
            clearInterval(countdownInterval);
            return;
        }

        const days = String(Math.floor(distance / (1000*60*60*24))).padStart(2,'0');
        const hours = String(Math.floor((distance % (1000*60*60*24)) / (1000*60*60))).padStart(2,'0');
        const minutes = String(Math.floor((distance % (1000*60*60)) / (1000*60))).padStart(2,'0');
        const seconds = String(Math.floor((distance % (1000*60)) / 1000)).padStart(2,'0');

        clock.innerHTML = `<span>${days}</span>:<span>${hours}</span>:<span>${minutes}</span>:<span>${seconds}</span>`;
    }, 1000);
}

// ========================== //
//           Puzzle           //
// ========================== //
const puzzleImages = {
    4: ['images/4x4/diana1.jpeg', 'images/4x4/diana2.jpeg', 'images/4x4/disegno2.jpeg', 'images/4x4/eevolution.png', 'images/4x4/messaggio1.png', 'images/4x4/messaggio2.png', 'images/4x4/musino2.jpeg'],
    5: ['images/5x5/disegno1.jpeg', 'images/5x5/Eevee.png', 'images/5x5/fumetto2.jpeg', 'images/5x5/messaggio3.png', 'images/5x5/musino1.jpeg'],
};

const puzzleContainer = document.getElementById('puzzleContainer');
const poolContainer = document.getElementById('puzzlePiecesPool');

function createPuzzle(size, imgSrc){
    puzzleContainer.style.setProperty('--size', size);
    puzzleContainer.innerHTML = '';
    poolContainer.innerHTML = '';

    const totalPieces = size*size;
    let pieces = [];

    // Crea slot vuoti
    for(let i=0;i<totalPieces;i++){
        const slot = document.createElement('div');
        slot.classList.add('puzzleSlot');
        slot.dataset.index = i;
        slot.addEventListener('dragover', dragOver);
        slot.addEventListener('drop', dropPiece);
        puzzleContainer.appendChild(slot);
    }

    // Crea pezzi con l'immagine unica
    for(let i=0;i<totalPieces;i++){
        const piece = document.createElement('div');
        piece.classList.add('puzzlePiece');
        piece.style.backgroundImage = `url('${imgSrc}')`;
        piece.style.backgroundSize = `${size*100}% ${size*100}%`;
        piece.style.backgroundPosition = `${-(i % size) * (100/(size-1))}% ${-Math.floor(i/size)*(100/(size-1))}%`;
        piece.draggable = true;
        piece.dataset.index = i;
        piece.addEventListener('dragstart', dragStart);
        pieces.push(piece);
    }

    // Shuffle e aggiungi al pool
    pieces = shuffleArray(pieces);
    pieces.forEach(p => poolContainer.appendChild(p));
}

// Avvia puzzle scegliendo immagine random per dimensione
function startPuzzle() {
    const size = parseInt(document.getElementById('puzzle-size').value);
    const imagesArray = puzzleImages[size];
    const randomIndex = Math.floor(Math.random() * imagesArray.length);
    const imgSrc = imagesArray[randomIndex]; // immagine singola
    createPuzzle(size, imgSrc);
}

// Shuffle array
function shuffleArray(array){
    for(let i=array.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

// Drag & Drop
let draggedPiece = null;
function dragStart(e){ draggedPiece = e.target; }
function dragOver(e){ e.preventDefault(); }
function dropPiece(e){
    e.preventDefault();
    const slot = e.target.closest('.puzzleSlot');
    if(!slot) return;

    if(!slot.style.backgroundImage){
        slot.style.backgroundImage = draggedPiece.style.backgroundImage;
        slot.style.backgroundSize = draggedPiece.style.backgroundSize;
        slot.style.backgroundPosition = draggedPiece.style.backgroundPosition;
        draggedPiece.remove();
    } else {
        const tempBg = slot.style.backgroundImage;
        const tempSize = slot.style.backgroundSize;
        const tempPos = slot.style.backgroundPosition;

        slot.style.backgroundImage = draggedPiece.style.backgroundImage;
        slot.style.backgroundSize = draggedPiece.style.backgroundSize;
        slot.style.backgroundPosition = draggedPiece.style.backgroundPosition;

        draggedPiece.style.backgroundImage = tempBg;
        draggedPiece.style.backgroundSize = tempSize;
        draggedPiece.style.backgroundPosition = tempPos;
    }

    checkPuzzle();
}

// Controlla completamento puzzle
function checkPuzzle(){
    const slots = Array.from(document.querySelectorAll('.puzzleSlot'));
    let allPlaced = true;
    slots.forEach(slot => {
        if(!slot.style.backgroundImage){
            allPlaced = false;
        }
    });

    if(allPlaced){
        document.getElementById('WinMessage').classList.remove('hidden');
        const winSound = document.getElementById('WinSound');
        if(winSound) winSound.play();
    }
}